<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Backbone Extended Data Services (BEDS)</title>
    <script src="./qunit/qunit.js"></script>


    <!-- Required libraries and setup -->
    <script type="text/javascript" src="../../jquery/jquery-2.0.0.min.js"></script>
    <script type="text/javascript" src="../../lodash/lodash.js"></script>
    <script type="text/javascript" src="../../lodash/plugins/underscore.string.js"></script>
    <script type="text/javascript">
        // Force no-globals check
        // Querystring parsing method from: http://stevenbenner.com/2010/03/javascript-regex-trick-parse-a-query-string-into-an-object/
        // It's far from flawless, but sufficient for our needs. For something more robust: http://stackoverflow.com/questions/901115/how-can-i-get-query-string-values#3855394
        var qs = {};
        location.search.replace(
            new RegExp("([^?=&]+)(=([^&]*))?", "g"),
            function($0, $1, $2, $3) { qs[$1] = $3; }
        );

        if(!qs.noglobals) {
            qs.noglobals = "true";
            location.search = $.param(qs);
        }

        // Mixin underscore.string library
        _.mixin(_.string.exports());
    </script>
    <script type="text/javascript" src="../../backbone/backbone.js"></script>


    <!-- Data services and setup -->
    <script type="text/javascript" src="../services/memory.js"></script>
    <script type="text/javascript" src="../services/accessors.js"></script>
    <script type="text/javascript" src="../services/autosave.js"></script>
    <script type="text/javascript" src="../services/consistency.js"></script>
    <script type="text/javascript" src="../services/load.js"></script>
    <script type="text/javascript" src="../services/singleton.js"></script>
    <script type="text/javascript" src="../services/util.js"></script>

    <script type="text/javascript">
    var MemoryBackbone = _.extend({}, Backbone);
    var AccessorBackbone = _.extend({}, Backbone);
    var AutosaveBackbone = _.extend({}, Backbone);
    var ConsistencyBackbone = _.extend({}, Backbone);
    var LoaderBackbone = _.extend({}, Backbone);
    var SingletonBackbone = _.extend({}, Backbone);
    var UtilBackbone = _.extend({}, Backbone);

    addMemory(MemoryBackbone);

    addAccessors(AccessorBackbone);
    addAutosave(AutosaveBackbone);

    addConsistency(ConsistencyBackbone);
    addAutosave(ConsistencyBackbone);

    addLoaders(LoaderBackbone);
    addSingleton(SingletonBackbone);

    addUtils(UtilBackbone);
    </script>


    <!-- Tests -->
    <script src="./test-memory.js"></script>
    <script src="./test-accessors.js"></script>
    <script src="./test-autosave.js"></script>
    <script src="./test-consistency.js"></script>
    <script src="./test-load.js"></script>
    <script src="./test-singleton.js"></script>
    <script src="./test-util.js"></script>


    <link rel="stylesheet" href="./qunit/qunit.css">
</head>
<body>
    <div id="qunit"></div>
    <div id="qunit-fixture"></div>
</body>
</html>